name: build-package
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install development files for Lua 5.2 
        run: sudo apt install --no-install-recommends lua5.2 liblua5.2-dev
      - name: Build prosody native utils (hashes.c)
        run: |
          cd prosody/util-src
          sh configure
          make
      - name: Archive production artifacts
        uses: actions/upload-artifact@v2
        with:
          name: prosody-native-utils-amd64
          path: |
            prosody/util-src/hashes.so
